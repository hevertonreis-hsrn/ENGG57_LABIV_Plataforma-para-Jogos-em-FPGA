#include <io.h>
#include <system.h>

// Registradores internos do master_interface
#define REG_FRAME_MODE        0  // offset 0
#define REG_OFFSET_R          2  // offset 4 (em bytes)
#define REG_OFFSET_L		  4
#define FRAME_MODE_COLOR      1  // por exemplo

int main() {
    int offset = 0;
    int last_btn = 0;

    // Envia modo inicial de frame
    IOWR_16DIRECT(MASTER_INTERFACE_BASE, REG_FRAME_MODE, FRAME_MODE_COLOR);

    while (1) {
        int btns = IORD_16DIRECT(KEY_BASE, 0);

        // Detecta borda de botão pressionado (para evitar repetição)
        if (btns != last_btn) {
            if ((btns & 0x01) != 0) {  // botão 01 (direita)
                offset = 111;
                // Atualiza offset no master_interface
				IOWR_16DIRECT(MASTER_INTERFACE_BASE, REG_OFFSET_R, offset);
            } else if ((btns & 0x02) != 0) {  // botão 10 (esquerda)
                offset = 222;
                // Atualiza offset no master_interface
				IOWR_16DIRECT(MASTER_INTERFACE_BASE, REG_OFFSET_L, offset);
            }
        }

        last_btn = btns;
    }

    return 0;
}
